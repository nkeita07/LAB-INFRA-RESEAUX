ğŸ“Œ Objectif

Ce lab dÃ©montre la mise en Å“uvre du protocole Open Shortest Path First (OSPF) dans une architecture multi-sites comprenant :

Plusieurs Fortinet FortiGate

Un routeur ISP central

Des rÃ©seaux LAN distincts

Interconnexion dynamique via Area 0

ğŸ—ºï¸ Topologie

ğŸ—ï¸ Architecture Logique
LAN Site A (192.168.1.0/24)
        |
      FGT2
        |
    20.20.20.0/24
        |
       ISP
        |
    40.40.40.0/24
        |
      FGT3
        |
LAN Site B (192.168.3.0/24)

                |
              FGT1
                |
          192.168.2.0/24
ğŸŒ Plan dâ€™Adressage
Segment	RÃ©seau
LAN Site A	192.168.1.0/24
LAN Site B	192.168.3.0/24
LAN Site C	192.168.2.0/24
FGT2 â†” ISP	20.20.20.0/24
ISP â†” FGT3	40.40.40.0/24
FGT1 â†” ISP	30.30.30.0/24
ğŸ§  Logique Fonctionnelle
ğŸ¯ But du protocole OSPF

Permettre :

Lâ€™apprentissage automatique des rÃ©seaux distants

La convergence rapide en cas de panne

Lâ€™Ã©limination du routage statique

Une architecture scalable multi-sites

ğŸ” Sens du Trafic
Exemple : PC1 (192.168.1.10) â†’ PC6 (192.168.3.10)

PC1 envoie vers sa gateway (FGT2)

FGT2 consulte sa table OSPF

Route apprise via ISP

Transit par rÃ©seau 20.20.20.0

ISP redirige vers FGT3 via 40.40.40.0

FGT3 route vers LAN 192.168.3.0

Le chemin est dÃ©terminÃ© dynamiquement via lâ€™algorithme SPF (Dijkstra).

ğŸ”¥ Configuration OSPF â€“ FortiGate
Sur FGT2 (Site A)
config router ospf
    set router-id 2.2.2.2

    config area
        edit 0.0.0.0
        next
    end

    config network
        edit 1
            set prefix 192.168.1.0 255.255.255.0
            set area 0.0.0.0
        next
        edit 2
            set prefix 20.20.20.0 255.255.255.0
            set area 0.0.0.0
        next
    end
end
Sur FGT3 (Site B)
config router ospf
    set router-id 3.3.3.3

    config area
        edit 0.0.0.0
        next
    end

    config network
        edit 1
            set prefix 192.168.3.0 255.255.255.0
            set area 0.0.0.0
        next
        edit 2
            set prefix 40.40.40.0 255.255.255.0
            set area 0.0.0.0
        next
    end
end
Sur FGT1 (Site C)
config router ospf
    set router-id 1.1.1.1

    config area
        edit 0.0.0.0
        next
    end

    config network
        edit 1
            set prefix 192.168.2.0 255.255.255.0
            set area 0.0.0.0
        next
        edit 2
            set prefix 30.30.30.0 255.255.255.0
            set area 0.0.0.0
        next
    end
end
ğŸ” Configuration ISP (Cisco)
enable
configure terminal
router ospf 1
 router-id 10.10.10.10

 network 20.20.20.0 0.0.0.255 area 0
 network 40.40.40.0 0.0.0.255 area 0
 network 30.30.30.0 0.0.0.255 area 0
end
ğŸ” VÃ©rifications
Sur FortiGate
get router info ospf neighbor
get router info ospf database
get router info routing-table all
Sur Cisco ISP
show ip ospf neighbor
show ip route
show ip ospf database
ğŸ§ª Tests de ConnectivitÃ©

Depuis PC1 :

ping 192.168.3.10

RÃ©sultat attendu :

Route apprise en OSPF

Chemin via ISP

Pas de route statique configurÃ©e

ğŸ§  Concepts ClÃ©s DÃ©montrÃ©s

Link-State Protocol

LSAs (Type 1 & 2)

Area 0 Backbone

SPF Algorithm

Convergence dynamique

Route redistribution possible

MÃ©trique basÃ©e sur coÃ»t

âš™ï¸ Ce Que Ce Lab Prouve Techniquement

MaÃ®trise du routage dynamique

Architecture multi-firewalls

Interconnexion inter-sites

Bonne comprÃ©hension du forwarding path

Debug OSPF sur FortiGate et Cisco
